# Stage 15 보스 전면 개편: "NEXUS" 사이버 코어 보스

## 개요

기존 Magnetar 보스를 완전히 새로운 **"NEXUS"** 보스로 교체합니다.
사이버 월드의 핵심 AI가 뱀을 바이러스로 인식하고 제거하려는 컨셉입니다.

---

## 1. 보스 디자인: NEXUS

### 비주얼 컨셉
```
        ╔═══════════╗
      ╔═╝           ╚═╗
    ╔═╝   ┌─────┐    ╚═╗
   ╔╝     │CORE │      ╚╗      ← 중앙 코어 (맥동하는 시안색)
   ║   ◊  └─────┘   ◊   ║      ← 좌우 데이터 노드
   ╚╗     ═══════     ╔╝       ← 하단 데이터 스트림
    ╚═╗             ╔═╝
      ╚═╗         ╔═╝
        ╚═════════╝
```

### 색상 테마
- **기본**: 시안(0x00ffff) + 마젠타(0xff00ff) 그라데이션
- **코어**: 어두운 보라(0x4400aa) → 밝은 시안(0x00ffff) 펄스
- **위협 시**: 빨강(0xff0000) 글로우
- **Vulnerable**: 초록(0x00ff00) 글로우 + "HIT ME!" 텍스트

### 애니메이션
- 코어: 1초 주기로 펄스 (1.0x → 1.15x 스케일)
- 외곽 육각형: 천천히 회전 (10초에 1바퀴)
- 데이터 스트림: 위에서 아래로 흐르는 0/1 패턴
- 글리치 효과: 간헐적으로 위치가 떨리는 효과

---

## 2. 인트로 연출 시퀀스

### 타임라인 (약 12초)

| 시간 | 이벤트 |
|------|--------|
| 0.0s | 가스존 확장 멈춤 + 화면 글리치 시작 |
| 1.0s | 화면 중앙에 "SYSTEM ALERT" 텍스트 (빨강, 깜빡임) |
| 2.5s | 가스존이 역으로 축소 (안전 영역 확대) |
| 4.0s | 글리치 최고조 + 화면 플래시 |
| 4.5s | NEXUS 코어 등장 (중앙에서 확대) |
| 5.5s | 대사: "VIRUS DETECTED IN SECTOR 7-G" |
| 7.0s | 대사: "INITIATING PURGE PROTOCOL..." |
| 8.5s | 대사: "TARGET: SNAKE.EXE" |
| 10.0s | "NEXUS ONLINE" 대형 텍스트 + 보스 HP UI 등장 |
| 11.5s | Phase 1 시작 |

### 대사 스타일
- 타자기 효과 (글자 하나씩 표시)
- 시안색 텍스트 + 터미널 스타일 폰트
- 각 대사 후 "_" 커서 깜빡임

---

## 3. 회피 시스템: 위상 대시 (Phase Dash)

### 조작
- **SPACE 홀드**: 차지 게이지 충전 (최대 1초)
- **SPACE 릴리즈**: 현재 방향으로 대시

### 대시 거리
- 최소 차지 (0.2초): 2칸 대시
- 최대 차지 (1.0초): 6칸 대시

### 대시 중 특성
- **무적 프레임**: 대시 이동 중 모든 공격 무시
- **잔상 효과**: 4개의 반투명 뱀 잔상이 따라옴
- **트레일**: 시안색 에너지 트레일

### 쿨다운
- 대시 후 2초 쿨다운
- 쿨다운 UI: 화면 하단 중앙에 게이지 표시

### 벽 충돌
- 대시 중 벽에 부딪히면 벽 직전에서 멈춤 (죽지 않음)

---

## 4. 보스 Phase 구성

### Phase 1: SCAN PROTOCOL (1 HIT 필요)

#### 공격 패턴
1. **수직 스캔 빔** (3초 주기)
   - 왼쪽에서 오른쪽으로 레이저 라인이 이동
   - 경고: 빨간 점선이 먼저 표시 (1초)
   - 발사: 마젠타 레이저 (닿으면 즉사)
   - 안전: 레이저 뒤로 대시하거나 빈 칸으로 이동

2. **수평 스캔 빔** (4초 주기)
   - 위에서 아래로 레이저 라인 이동
   - 같은 경고/발사 패턴

3. **콤보 스캔** (7초 후)
   - 수직 + 수평 동시 발사
   - 교차점을 피해야 함

#### HIT 방법
- 스캔 사이클 완료 후 2초간 코어가 초록색으로 변함
- 코어 위치로 이동하면 HIT

#### 코어 위치
- 맵 중앙 고정

---

### Phase 2: DATA STORM (2 HIT 필요)

#### 공격 패턴
1. **데이터 블록 낙하** (2초 주기)
   - 하늘에서 마젠타 큐브가 떨어짐
   - 그림자가 먼저 표시 (0.8초 경고)
   - 5~8개가 랜덤 위치에 동시 낙하
   - 대시로 회피 권장

2. **바이러스 추적탄** (4초 주기)
   - 코어에서 뱀 방향으로 3발 발사
   - 느린 유도탄 (1초에 3칸 이동)
   - 벽에 부딪히면 소멸
   - 대시로 따돌리기

3. **EMP 서지** (8초 주기)
   - 코어에서 원형 충격파 발생
   - 반경 점점 확대 (0 → 15칸)
   - 대시로 충격파 통과 가능 (무적 프레임)

#### HIT 방법
- 공격 패턴 3회 반복 후 2초간 vulnerable
- 코어 위치로 이동하면 HIT
- 2번 HIT해야 Phase 3 진입

#### 코어 위치
- 맵 중앙 고정 (Phase 1과 동일)

---

### Phase 3: FIREWALL SURGE (1 HIT 필요)

#### 특수 메커니즘
1. **가스존 가속**
   - 확장 간격: 2000ms → 1000ms (2배 빠름)
   - 최소 반경: 4 → 6 (더 좁아짐)

2. **코어 텔레포트**
   - 3초마다 코어가 랜덤 위치로 텔레포트
   - 텔레포트 전 글리치 효과 (0.5초)

3. **지뢰 필드**
   - 코어 텔레포트 시 이전 위치에 지뢰 1개 생성
   - 지뢰는 5초 후 폭발 (주변 3x3 영역 피해)
   - 뱀이 밟으면 즉시 폭발

#### 공격 패턴
- Phase 1의 스캔 빔 + Phase 2의 데이터 블록 동시 발생
- 난이도 최고조

#### HIT 방법
- 텔레포트 직후 1.5초간 vulnerable
- 코어 위치로 이동하면 최종 HIT

---

## 5. 역공격 시스템

### HIT 카운트
| Phase | HIT 필요 | 누적 HIT |
|-------|---------|---------|
| Phase 1 | 1 | 1 |
| Phase 2 | 2 | 3 |
| Phase 3 | 1 | 4 (클리어) |

### HIT 피드백
1. 화면 플래시 (시안색)
2. 카메라 쉐이크 (0.3초)
3. "HIT X/4!" 텍스트 (노란색, 크게)
4. 보스 피격 애니메이션 (빨간 깜빡임)
5. 보스 HP 바 감소 애니메이션
6. Phase 전환 시 "PHASE X COMPLETE" 메시지

### Vulnerable 상태 표시
- 코어: 보라색 → 초록색
- "CORE EXPOSED!" 텍스트 표시
- 펄스 속도 2배 빨라짐
- 글로우 이펙트 강화

---

## 6. 엔딩 연출 시퀀스

### 타임라인 (약 8초)

| 시간 | 이벤트 |
|------|--------|
| 0.0s | 마지막 HIT → 보스 경직 |
| 0.5s | 화면 슬로우모션 (0.3x) |
| 1.0s | 보스 대사: "SYSTEM... FAILURE..." (빨간색, 떨림) |
| 2.0s | 글리치 폭발 시작 (픽셀 파편) |
| 2.5s | 가스존 급속 소멸 (역방향 확장) |
| 3.5s | 보스 코어 대폭발 (20개 파티클) |
| 4.0s | 화면 완전 화이트아웃 |
| 4.5s | "NEXUS TERMINATED" 텍스트 (녹색) |
| 5.5s | "FIREWALL DISABLED" 텍스트 |
| 6.5s | "+1000 BONUS!" 텍스트 |
| 7.0s | 노말 화면으로 복귀 |
| 8.0s | 상점 오픈 |

### 폭발 이펙트
- **글리치 파편**: 50개의 작은 사각형이 사방으로 튀어나감
- **EMP 링**: 코어 중심에서 시안색 원형 파동 3회
- **데이터 스트림 소멸**: 0/1 텍스트가 위로 올라가며 사라짐
- **화면 플래시**: 시안 → 화이트 → 페이드아웃

---

## 7. UI 요소

### 보스 HP 바
- 위치: 화면 상단 중앙
- 디자인: 시안색 바 + "NEXUS" 라벨
- 4칸으로 구분 (각 HIT당 1칸 감소)
- 피격 시 빨간 깜빡임

### Phase 표시
- 위치: HP 바 아래
- "PHASE 1: SCAN PROTOCOL" 형식
- Phase 전환 시 글리치 애니메이션

### 대시 쿨다운 게이지
- 위치: 화면 하단 중앙
- 원형 게이지 (시안색)
- 쿨다운 중: 회색 + 숫자 카운트다운
- 준비됨: 시안색 + "DASH READY" 텍스트

### 경고 표시
- 공격 패턴에 따른 경고 아이콘
- 스캔 빔: ⚠ SCAN INCOMING
- 데이터 스톰: ⚠ DATA INCOMING
- EMP 서지: ⚠ EMP SURGE

---

## 8. 구현 계획

### Phase 1: 기존 Magnetar 코드 정리
1. `cleanupMagnetar()` 함수 확장
2. 기존 Magnetar 관련 변수 초기화 로직 유지
3. 새 NEXUS 변수 추가

### Phase 2: 보스 그래픽 구현
1. `drawNexusBoss()` - 코어 + 육각형 + 데이터 스트림
2. `updateNexusAnimation()` - 60fps 애니메이션 루프
3. `showNexusVulnerable()` - vulnerable 상태 전환

### Phase 3: 인트로 연출
1. `startNexusIntro()` - 인트로 시퀀스 시작
2. `showNexusDialogue()` - 대사 표시 (타자기 효과)
3. `showNexusTitle()` - "NEXUS ONLINE" 타이틀

### Phase 4: 대시 시스템
1. `initDashSystem()` - 대시 시스템 초기화
2. `handleDashCharge()` - 차지 로직
3. `performDash()` - 대시 실행 + 무적
4. `renderDashTrail()` - 잔상 효과

### Phase 5: 공격 패턴
1. `startNexusPhase1()` - 스캔 빔 패턴
2. `startNexusPhase2()` - 데이터 스톰 + 추적탄 + EMP
3. `startNexusPhase3()` - 가속 가스존 + 텔레포트 + 지뢰

### Phase 6: HIT 시스템
1. `handleNexusHit()` - HIT 처리 + Phase 전환
2. `checkNexusCollision()` - 충돌 감지
3. `updateNexusHP()` - HP 바 업데이트

### Phase 7: 엔딩 연출
1. `showNexusVictory()` - 승리 시퀀스
2. `showNexusExplosion()` - 폭발 이펙트
3. `cleanupNexus()` - 정리 및 상점 전환

---

## 9. 예상 코드 라인

| 기능 | 예상 라인 |
|------|---------|
| 변수 및 초기화 | ~100 |
| 보스 그래픽 | ~200 |
| 인트로 연출 | ~250 |
| 대시 시스템 | ~150 |
| Phase 1 (스캔) | ~200 |
| Phase 2 (데이터 스톰) | ~300 |
| Phase 3 (서지) | ~250 |
| HIT 시스템 | ~100 |
| 엔딩 연출 | ~200 |
| UI 요소 | ~150 |
| **총계** | **~1900** |

---

## 10. 난이도 밸런스

### 현재 문제점
- 갑자기 죽는 느낌 (경고 부족)
- 회피 방법이 불명확
- 재미 요소 부족

### 개선 방향
- **명확한 경고**: 모든 공격에 1초 이상 경고 시간
- **회피 기회**: 대시 무적으로 위기 탈출 가능
- **학습 곡선**: Phase별로 난이도 점진적 상승
- **피드백**: HIT/피격 시 명확한 시청각 피드백
- **긴장감**: 가스존 + 공격 패턴 조합으로 압박

---

## 승인 요청

위 계획대로 Stage 15 NEXUS 보스를 구현해도 될까요?

주요 변경점:
1. ✅ 기존 Magnetar 보스 완전 교체
2. ✅ 새로운 대시 회피 시스템
3. ✅ 3 Phase 보스전 (총 4 HIT)
4. ✅ 화려한 인트로/엔딩 연출
5. ✅ 가스존과 시너지 있는 공격 패턴
